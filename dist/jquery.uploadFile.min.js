!function(){"use strict";var e={doc:"application/msword",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",ppt:"application/vnd.ms-powerpoint",pptx:"application/vnd.openxmlformats-officedocument.presentationml.presentation",xls:"application/vnd.ms-excel",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",pdf:"application/pdf",zip:"application/zip",xml:"application/xml",js:"application/javascript",json:"application/json",txt:"text/plain",html:"text/html",css:"text/css",jpg:"image/jpeg",jpeg:"image/jpeg",png:"image/png",gif:"image/gif",bmp:"image/bmp",webp:"image/webp",ico:"image/x-icon","img*":"image/*"};$.fn.extend({uploadFile:function(t){var a,i=this[0],n={},r=!1;try{t.accept&&t.accept.length>0&&(i.accept=t.accept.map(function(t,a){return e[t]||""}).join(",")),this.on("change",function(e){var i,o,c=e||window.event,p=c.target||c.srcElement;if(a=p.files[0],"function"==typeof t.onFileChange&&t.onFileChange(a),a){if(r=!0,t.accept)if(t.accept=t.accept.map(function(e,t,a){return"img*"===e&&(e="image"),e}),new RegExp("\\.(".concat(t.accept.join("|"),")$"),"g").test(a.name))r=!0;else if(r=!1,~a.type.indexOf("image")&&~t.accept.indexOf("image")&&(r=!0),!r)return t.acceptError&&t.acceptError(),!1;if(0===a.size)return t.sizeError&&t.sizeError(0),r=!1,!1;if(t.maxSize){if(a.size>(i=t.maxSize,/^\d+$/g.test(i)?0:(o=(i=i.toUpperCase().replace(/([B|K|M|G|T])/g,",$1")).split(","))[0]*{B:1,K:1024,M:1048576,G:1073741824,T:1099511627776}[o[1]]))return t.sizeError&&t.sizeError(1),r=!1,!1;r=!0}r&&t.previewBox&&function(e,t,a){var i=function(e){var t=new Image;t.src=e,t.id="imgTmp",t.onload=function(){a&&a(t)}};if(void 0!==FileReader){var n=new FileReader;n.onload=function(e){var t=e||window.event,a=(t.target||t.srcElement).result;i(a)},n.readAsDataURL(e)}else if(void 0!==URL){var r=window.URL.createObjectURL(e.files[0]);i(r)}else{e.select();var o=document.selection.createRange().text;t.innerHTML="",t.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled='true',sizingMethod='scale',src=\"".concat(o,'")'),a&&a(t)}}(a,$(t.previewBox).get(0),function(e){if(t.scale&&2===t.scale.length){if(!(e.width>=t.scale[0]&&e.height>=t.scale[1]&&e.height<=$(window).height()))return t.scaleError&&t.scaleError(),r=!1,!1;r=!0,$(t.previewBox).html(""),$(t.previewBox).append(e),t.previewCallBack&&t.previewCallBack(e,n)}else $(t.previewBox).html(""),$(t.previewBox).append(e),t.previewCallBack&&t.previewCallBack(e,n)})}else a=null,r=!1}),t.btn&&t.url&&$(t.btn).on("click",function(){var e=!0,i=new FormData;if("function"==typeof t.onBeforeSend&&(e=t.onBeforeSend(n)),e){if(t.data&&Object.keys(t.data).length>0)for(key in t.data)i.append(key,t.data[key]);if(n&&Object.keys(n).length>0)for(key in n)i.append(key,n[key]);if(r)i.append("file",a);else if("function"==typeof t.sendNull)return t.sendNull();$.ajax({url:t.url,method:"POST",data:i,processData:!1,contentType:!1,success:function(e,a,i){r=!1,t.ajaxSuccess&&t.ajaxSuccess(e)},error:function(e,a,i){t.ajaxError&&t.ajaxError(i)}})}})}catch(e){console.error(e)}return this}})}();
